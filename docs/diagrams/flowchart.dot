/*
 * Flowchart - Alur Peminjaman Sarpras
 * Dibuat dengan Graphviz DOT Language
 * 
 * Untuk menghasilkan gambar:
 * dot -Tpng flowchart.dot -o flowchart.png
 * dot -Tsvg flowchart.dot -o flowchart.svg
 */

digraph Flowchart {
    // ========================================
    // KONFIGURASI GLOBAL
    // ========================================
    graph [
        rankdir=TB
        splines=ortho
        nodesep=0.5
        ranksep=0.6
        fontname="Segoe UI"
        fontsize=12
        bgcolor="#f8fafc"
        pad=0.5
        dpi=150
        label=<<B><FONT POINT-SIZE="22" COLOR="#1e293b">Flowchart</FONT></B><BR/><FONT POINT-SIZE="12" COLOR="#64748b">Alur Proses Peminjaman Ruangan &amp; Barang</FONT>>
        labelloc=t
        labeljust=c
    ]
    
    node [
        fontname="Segoe UI"
        fontsize=10
        style="filled,rounded"
        penwidth=2
    ]
    
    edge [
        fontname="Segoe UI"
        fontsize=9
        color="#475569"
        penwidth=1.5
    ]

    // ========================================
    // START & END NODES
    // ========================================
    start [
        label="Mulai"
        shape=oval
        fillcolor="#1e293b"
        fontcolor="white"
    ]
    
    end_sukses [
        label="Selesai"
        shape=oval
        fillcolor="#22c55e"
        fontcolor="white"
    ]
    
    end_batal [
        label="Batal"
        shape=oval
        fillcolor="#ef4444"
        fontcolor="white"
    ]

    // ========================================
    // PROSES NODES (Kotak)
    // ========================================
    node [shape=box fillcolor="#dbeafe" color="#2563eb"]
    
    login [label="Mahasiswa\nLogin ke Sistem"]
    buka_menu [label="Buka Menu\nPeminjaman"]
    isi_form [label="Isi Formulir\nPeminjaman"]
    pilih_ruangan [label="Pilih Ruangan\n& Jadwal"]
    pilih_barang [label="Pilih Barang\n(Opsional)"]
    upload_surat [label="Upload Surat\nDigital"]
    submit [label="Submit\nPengajuan"]
    
    node [fillcolor="#dcfce7" color="#16a34a"]
    
    simpan_db [label="Simpan Data\nke Database"]
    kirim_notif_sarpras [label="Kirim Notifikasi\nke Sarpras"]
    kirim_notif_mhs [label="Kirim Notifikasi\nke Mahasiswa"]
    update_status [label="Update Status\nPeminjaman"]
    
    node [fillcolor="#fef3c7" color="#d97706"]
    
    review_sarpras [label="Sarpras Review\nDetail Peminjaman"]
    tambah_catatan [label="Tambah Catatan\nVerifikasi"]
    
    node [fillcolor="#fecdd3" color="#e11d48"]
    
    cek_security [label="Security Cek\nJadwal Hari Ini"]
    verif_kehadiran [label="Verifikasi\nKehadiran"]
    catat_kehadiran [label="Catat Status\nKehadiran"]

    // ========================================
    // DECISION NODES (Diamond)
    // ========================================
    node [shape=diamond fillcolor="#fef3c7" color="#f59e0b" width=1.5 height=1]
    
    cek_login [label="Sudah\nLogin?"]
    cek_valid [label="Data\nValid?"]
    cek_jadwal [label="Jadwal\nTersedia?"]
    cek_approve [label="Disetujui?"]
    cek_hadir [label="Peminjam\nHadir?"]

    // ========================================
    // INPUT/OUTPUT NODES (Parallelogram)
    // ========================================
    node [shape=parallelogram fillcolor="#f3e8ff" color="#9333ea"]
    
    input_credential [label="  Input Email\n  & Password  "]
    input_form [label="  Input Data\n  Peminjaman  "]
    output_sukses [label="  Tampilkan\n  Pesan Sukses  "]
    output_error [label="  Tampilkan\n  Pesan Error  "]
    output_jadwal [label="  Tampilkan\n  Jadwal Tersedia  "]

    // ========================================
    // DOCUMENT NODES
    // ========================================
    node [shape=note fillcolor="#cffafe" color="#0891b2"]
    
    doc_surat [label="Surat Digital\n(PDF/Image)"]
    doc_notif [label="Notifikasi\nStatus"]

    // ========================================
    // ALUR UTAMA
    // ========================================
    
    // Start -> Login Flow
    start -> cek_login
    
    cek_login -> buka_menu [label="  Ya  " color="#22c55e"]
    cek_login -> input_credential [label="  Tidak  " color="#ef4444"]
    input_credential -> login
    login -> buka_menu
    
    // Menu -> Form Flow
    buka_menu -> isi_form
    isi_form -> input_form
    input_form -> pilih_ruangan
    pilih_ruangan -> cek_jadwal
    
    cek_jadwal -> output_jadwal [label="  Ya  " color="#22c55e"]
    cek_jadwal -> output_error [label="  Tidak  " color="#ef4444"]
    output_error -> pilih_ruangan [style=dashed]
    
    output_jadwal -> pilih_barang
    pilih_barang -> upload_surat
    upload_surat -> doc_surat
    doc_surat -> submit
    
    // Submit -> Validasi Flow
    submit -> cek_valid
    
    cek_valid -> simpan_db [label="  Ya  " color="#22c55e"]
    cek_valid -> output_error [label="  Tidak  " color="#ef4444"]
    
    // Simpan -> Notifikasi Sarpras
    simpan_db -> kirim_notif_sarpras
    kirim_notif_sarpras -> review_sarpras
    
    // Review Sarpras -> Decision
    review_sarpras -> cek_approve
    
    cek_approve -> tambah_catatan [label="  Ya  " color="#22c55e"]
    cek_approve -> tambah_catatan [label="  Tidak  " color="#ef4444"]
    
    tambah_catatan -> update_status
    update_status -> kirim_notif_mhs
    kirim_notif_mhs -> doc_notif
    
    // Branch: Approved or Rejected
    doc_notif -> output_sukses [label="  APPROVED  " color="#22c55e"]
    doc_notif -> end_batal [label="  REJECTED  " color="#ef4444"]
    
    // Approved -> Security Check (Hari H)
    output_sukses -> cek_security [label="  Hari-H  "]
    cek_security -> verif_kehadiran
    verif_kehadiran -> cek_hadir
    
    cek_hadir -> catat_kehadiran [label="  Ya  " color="#22c55e"]
    cek_hadir -> catat_kehadiran [label="  Tidak  " color="#ef4444"]
    
    catat_kehadiran -> end_sukses

    // ========================================
    // LEGEND
    // ========================================
    subgraph cluster_legend {
        label=<<B><FONT POINT-SIZE="11" COLOR="#475569">ðŸ“Œ KETERANGAN SIMBOL</FONT></B>>
        style="rounded,filled"
        fillcolor="#f1f5f9"
        color="#cbd5e1"
        penwidth=1
        margin=20
        
        node [shape=plaintext fillcolor="#f1f5f9" width=0 height=0]
        
        legend [label=<<TABLE BORDER="0" CELLBORDER="0" CELLSPACING="8">
            <TR>
                <TD BGCOLOR="#1e293b" WIDTH="40" HEIGHT="20" STYLE="rounded"><FONT COLOR="white" POINT-SIZE="8">Oval</FONT></TD>
                <TD ALIGN="LEFT"><FONT POINT-SIZE="9">Start / End</FONT></TD>
                <TD WIDTH="15"></TD>
                <TD BGCOLOR="#dbeafe" WIDTH="40" HEIGHT="20" STYLE="rounded" BORDER="1"><FONT POINT-SIZE="8">Box</FONT></TD>
                <TD ALIGN="LEFT"><FONT POINT-SIZE="9">Proses</FONT></TD>
            </TR>
            <TR>
                <TD BGCOLOR="#fef3c7" WIDTH="40" HEIGHT="20"><FONT POINT-SIZE="8">â—‡</FONT></TD>
                <TD ALIGN="LEFT"><FONT POINT-SIZE="9">Keputusan</FONT></TD>
                <TD WIDTH="15"></TD>
                <TD BGCOLOR="#f3e8ff" WIDTH="40" HEIGHT="20" STYLE="rounded" BORDER="1"><FONT POINT-SIZE="8">â–±</FONT></TD>
                <TD ALIGN="LEFT"><FONT POINT-SIZE="9">Input/Output</FONT></TD>
            </TR>
            <TR>
                <TD BGCOLOR="#cffafe" WIDTH="40" HEIGHT="20" STYLE="rounded" BORDER="1"><FONT POINT-SIZE="8">ðŸ“„</FONT></TD>
                <TD ALIGN="LEFT"><FONT POINT-SIZE="9">Dokumen</FONT></TD>
                <TD WIDTH="15"></TD>
                <TD></TD>
                <TD></TD>
            </TR>
        </TABLE>>]
    }
}
